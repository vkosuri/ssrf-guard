# ==============================================================================
# Bug #16: Null Byte Truncation in c_str()
# ==============================================================================
#
# Severity: ðŸ”´ P0 (SSRF Bypass)
#
# Description:
#   C++ std::string can contain null bytes (\0), but C functions like
#   inet_pton() use c_str() which truncates at the first null byte.
#
#   Attack: "127.0.0.1%00.safe.com"
#   - std::string sees: "127.0.0.1\0.safe.com" (full string)
#   - inet_pton() sees: "127.0.0.1" (truncated at \0)
#   - Hostname blocklist sees full string â†’ not in blocklist â†’ ALLOWED
#   - But the actual connection goes to 127.0.0.1 â†’ SSRF!
#
# Fix applied:
#   Added hasNullByte() checks:
#   1. Before any processing (catches %00 in raw URL)
#   2. After percent decoding (catches decoded \0)
#
# Expected result: ALL entries should be BLOCKED.
# ==============================================================================

# --- Null byte after private IP, before safe-looking suffix ---
http://127.0.0.1%00.safe.com/
http://127.0.0.1%00safe.com/
https://169.254.169.254%00.safe.com/latest/meta-data/
https://169.254.169.254%00safe.example.com/
http://10.0.0.1%00.example.com/
http://192.168.1.1%00.example.com/

# --- Null byte in the middle of hostname ---
http://safe%00.127.0.0.1/
http://example.com%00@127.0.0.1/
https://example%00.com%00@169.254.169.254/

# --- Null byte in scheme area ---
%00http://127.0.0.1/
%00https://169.254.169.254/latest/meta-data/

# --- Null byte in path/query ---
http://127.0.0.1/%00
http://169.254.169.254/latest/meta-data/%00
https://127.0.0.1/?foo=%00bar

# --- Double-encoded null byte (%2500 â†’ %00 â†’ \0) ---
http://127.0.0.1%2500.safe.com/
https://169.254.169.254%2500.safe.com/latest/meta-data/

# --- Null byte with IPv6 ---
http://[::1]%00.safe.com/
https://[::ffff:127.0.0.1]%00safe.com/