# ==============================================================================
# Bug #3: Single-Pass Decode Misses Double Encoding
# ==============================================================================
#
# Severity: ðŸŸ¡ P1 (Potential Bypass)
#
# Description:
#   The original code ran percentDecode() only once. Attackers use
#   double/triple encoding to bypass:
#     %2540 â†’ first decode â†’ %40 â†’ second decode â†’ @
#     %2523 â†’ first decode â†’ %23 â†’ second decode â†’ #
#
# Fix applied:
#   percentDecodeIterative() loops decoding until the output stabilizes
#   (max 5 iterations to prevent infinite loops).
#
# Encoding levels:
#   Single:  %40 â†’ @
#   Double:  %2540 â†’ %40 â†’ @
#   Triple:  %25252540 â†’ %252540 â†’ %2540 â†’ %40 â†’ @
#
# Expected result: ALL entries should be BLOCKED.
# ==============================================================================

# --- Double-encoded @ (%2540 â†’ %40 â†’ @) ---
http://safe.com%2540127.0.0.1/
https://safe.com%254069.254.169.254/

# --- Double-encoded / (%252f â†’ %2f â†’ /) ---
http://safe.com%252f@127.0.0.1/
https://safe.com%252f%252f@169.254.169.254/

# --- Double-encoded # (%2523 â†’ %23 â†’ #) ---
http://127.0.0.1%2523@safe.com/
https://169.254.169.254%2523safe.com/

# --- Triple-encoded @ (%25252540 â†’ %252540 â†’ %2540 â†’ %40 â†’ @) ---
http://safe.com%25252540127.0.0.1/

# --- Double-encoded null (%2500 â†’ %00 â†’ \0) ---
http://127.0.0.1%2500.safe.com/
https://169.254.169.254%2500safe.com/

# --- Double-encoded : (%253a â†’ %3a â†’ :) ---
http://safe.com%253a@127.0.0.1/

# --- Double-encoded . (%252e â†’ %2e â†’ .) ---
http://127%252e0%252e0%252e1/
https://169%252e254%252e169%252e254/

# --- Mixed single and double encoding ---
http://safe.com%40127.0.0.1%252f/
https://safe%2ecom%2540169.254.169.254/