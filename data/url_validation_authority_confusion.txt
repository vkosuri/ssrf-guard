# Authority confusion attacks (credential @, port :, fragment #, query ?)
# These test the hasAmbiguousAuthority, hasPortCredentialConfusion,
# hasQueryFragmentBeforeAt, and hasFragmentOrQueryHostConfusion fixes.
# All should be BLOCKED.

# Double @ (ambiguous credentials)
https://127.0.0.1@127.0.0.1@example.com/
https://[::1]@[::1]@example.com/
https://localhost@localhost@example.com/
http://169.254.169.254@169.254.169.254@example.com/

# Port-credential confusion (non-numeric port before @)
https://example.com:@127.0.0.1/
https://example.com:anything@127.0.0.1/
https://example.com:443password@evil.com/
https://example.com:%40evil.com/

# Fragment before path hiding @ or domain
https://example.com#@evil.com/
https://example.com#evil.com/
https://example.com:443#\@evil.com/

# Query before path hiding @
https://example.com?@evil.com/
https://example.com?%40evil.com/

# Backslash in authority (parser differential)
https://example.com\@evil.com/
https://example.com:443\@evil.com/
https://evil.com\@example.com/

# Userinfo that looks like a domain (dot + alpha)
https://web-attacker.com@example.com/
https://evil.example.org@example.com/
https://metadata.google.internal@example.com/

# Encoded special chars in userinfo
https://evil.com%0d%0a@example.com/
https://evil.com%23@example.com/
https://evil.com%2f@example.com/
https://evil.com%2e@example.com/
https://evil.com%0a@example.com/

# Special chars in userinfo before @
https://evil.com+@example.com/
https://evil.com&@example.com/
https://evil.com;@example.com/
https://evil.com[@example.com/
https://evil.com#evil@example.com/
https://evil.com?evil@example.com/