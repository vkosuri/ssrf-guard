# ==============================================================================
# Bug #7: TLD Substring Match False Positives
# ==============================================================================
#
# Severity: üü° P1 (Availability ‚Äî False Positives)
#
# Description:
#   The original code used find() (substring search) for TLD matching:
#     if (host.find(".local") != string::npos) return true;
#
#   This caused FALSE POSITIVES ‚Äî legitimate domains containing the
#   TLD string as a substring were incorrectly blocked:
#     "notlocal.com"     ‚Üí contains ".local" ‚Üí BLOCKED (wrong!)
#     "testingsite.com"  ‚Üí contains ".test"  ‚Üí BLOCKED (wrong!)
#     "myexample.org"    ‚Üí contains ".example" ‚Üí BLOCKED (wrong!)
#
# Fix applied:
#   Replaced find() with hasSuffix() ‚Äî only matches if the TLD is
#   at the END of the hostname:
#     "notlocal.com"    ‚Üí does NOT end with ".local" ‚Üí allowed
#     "myapp.local"     ‚Üí ends with ".local" ‚Üí BLOCKED (correct!)
#
# Expected result: SHOULD_BLOCK entries should be blocked.
#                  Commented-out SHOULD_ALLOW entries would pass suffix
#                  check but may be blocked by DNS failure (fail-secure).
# ==============================================================================

# --- SHOULD_BLOCK: Actual reserved TLD suffixes ---
http://myrouter.local/
http://printer.local/
http://myapp.test/
http://demo.example/
http://bad.invalid/
http://service.internal/
http://evil.localhost/

# --- SHOULD_BLOCK: Exact TLD names ---
http://local/
http://localhost/
http://test/
http://example/
http://invalid/
http://internal/

# --- SHOULD_ALLOW (commented): Legitimate domains with TLD substrings ---
# These were FALSE POSITIVES with the old buggy find() approach.
# With the fixed hasSuffix() approach, these pass the TLD check.
# They may still be blocked by DNS failure or allowlist.
#
# http://notlocal.com/          ‚Üê contains ".local" as substring
# http://testingsite.com/       ‚Üê contains ".test" as substring
# http://myexample.org/         ‚Üê contains ".example" as substring
# http://bestexample-site.com/  ‚Üê contains ".example" as substring
# http://internal-tools.com/    ‚Üê contains ".internal" as substring
# http://localhost-proxy.com/   ‚Üê contains ".localhost" as substring